<!DOCTYPE html>
<html>
  <head>
    <title>Metamorph Hacks</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.46" />
<title>Metamorph :: Metamorph Hacks</title>
<link rel="shortcut icon" href="/metamorph-hacks/images/favicon.png" type="image/x-icon" />
<link href="/metamorph-hacks/css/font-awesome.min.css" rel="stylesheet">
<link href="/metamorph-hacks/css/nucleus.css" rel="stylesheet">
<link href="/metamorph-hacks/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/metamorph-hacks/css/bootstrap.min.css">
<script src="/metamorph-hacks/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/sschuepbach.github.io\/metamorph-hacks";
</script>
<link rel="stylesheet" href="/metamorph-hacks/css/custom.css">


    
  </head>
  <body data-url="/metamorph-hacks/einfuehrung/metamorph/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="https://sschuepbach.github.io/metamorph-hacks">Metamorph Hacks</a>
  

  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/sschuepbach/metamorph-hacks"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Code</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/metafacture/metafacture-core"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Metafacture code</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/metafacture/metafacture-core/wiki/"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Metafacture wiki</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/metamorph-hacks/" class="dd-item">
          <a href="/metamorph-hacks/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/metamorph-hacks/einfuehrung/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/metamorph-hacks/einfuehrung/">Einführung</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/metamorph-hacks/einfuehrung/metamorph/" class="dd-item active">
        <div>
          <a href="/metamorph-hacks/einfuehrung/metamorph/">
            Metamorph
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/einfuehrung/hinweise-codebeispiele/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/einfuehrung/hinweise-codebeispiele/">
            Hinweise zu Codebeispielen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/metamorph-hacks/literale/" class="dd-item haschildren
        ">
      <div>
      <a href="/metamorph-hacks/literale/">Literale</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/metamorph-hacks/literale/datenfelder/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/literale/datenfelder/">
            Werte auslesen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/literale/transformationen/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/literale/transformationen/">
            Transformationen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/literale/filter/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/literale/filter/">
            Filter
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/literale/nachschlagetabellen/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/literale/nachschlagetabellen/">
            Nachschlagetabellen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/metamorph-hacks/collectors/" class="dd-item haschildren
        ">
      <div>
      <a href="/metamorph-hacks/collectors/">Collectors</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/metamorph-hacks/collectors/uebersicht/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/collectors/uebersicht/">
            Übersicht collectors
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/collectors/ausgabesteuerung/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/collectors/ausgabesteuerung/">
            Ausgabesteuerung
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/collectors/if-anweisungen/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/collectors/if-anweisungen/">
            if-Anweisungen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/metamorph-hacks/modularisierung/" class="dd-item haschildren
        ">
      <div>
      <a href="/metamorph-hacks/modularisierung/">Modularisierung</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/metamorph-hacks/modularisierung/rekursion/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/modularisierung/rekursion/">
            Rekursion
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/modularisierung/variablen/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/modularisierung/variablen/">
            Variablen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/modularisierung/makros/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/modularisierung/makros/">
            Makros
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/modularisierung/includes/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/modularisierung/includes/">
            Includes
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/metamorph-hacks/kochbuch/" class="dd-item haschildren
        ">
      <div>
      <a href="/metamorph-hacks/kochbuch/">Kochbuch</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/metamorph-hacks/kochbuch/literale-in-entitaeten-wiederverwenden/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/kochbuch/literale-in-entitaeten-wiederverwenden/">
            Literale in Entitäten wiederverwenden
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/kochbuch/ordnung-von-feldwerten-umdrehen/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/kochbuch/ordnung-von-feldwerten-umdrehen/">
            Ordnung von Werten in einem Literal umdrehen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/kochbuch/ordnung-von-literalen-aendern/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/kochbuch/ordnung-von-literalen-aendern/">
            Ordnung von Literalen ändern
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/kochbuch/nur-letzten-wert-beruecksichtigen/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/kochbuch/nur-letzten-wert-beruecksichtigen/">
            Nur letzten Wert eines Literals berücksichtigen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/metamorph-hacks/anhang/" class="dd-item haschildren
        ">
      <div>
      <a href="/metamorph-hacks/anhang/">Anhang</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/metamorph-hacks/anhang/metamorph-erweitern/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/anhang/metamorph-erweitern/">
            Metamorph erweitern
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/anhang/lsb-morphs/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/anhang/lsb-morphs/">
            Morphs in linked-swissbib
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/metamorph-hacks/anhang/ressourcen/" class="dd-item">
        <div>
          <a href="/metamorph-hacks/anhang/ressourcen/">
            Ressourcen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/metamorph-hacks/einfuehrung/" >
   Einführung</option> 
      <option value="/metamorph-hacks/einfuehrung/metamorph/"  selected>- Metamorph</option>
      <option value="/metamorph-hacks/einfuehrung/hinweise-codebeispiele/" >- Hinweise zu Codebeispielen</option>
  
    <option value="/metamorph-hacks/literale/" >
   Literale</option>
    <option value="/metamorph-hacks/collectors/" >
   Collectors</option>
    <option value="/metamorph-hacks/modularisierung/" >
   Modularisierung</option>
    <option value="/metamorph-hacks/kochbuch/" >
   Kochbuch</option>
    <option value="/metamorph-hacks/anhang/" >
   Anhang</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="/metamorph-hacks/js/lunr.min.js"></script>
        <script type="text/javascript" src="/metamorph-hacks/js/auto-complete.js"></script>
        <link href="/metamorph-hacks/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/sschuepbach.github.io\/metamorph-hacks";
          
        </script>
        <script type="text/javascript" src="/metamorph-hacks/js/search.js"></script>
      </div>
    

    <h1>Metamorph</h1>
    
    
    
    

<p>Innerhalb von Metafacture nimmt Metamorph die Rolle einer DSL
(&ldquo;Domain-specific language&rdquo;) ein, mit welcher einzelne Schlüssel-Wert-Paare
(sogenannte <em>Literale</em>) von Datensätzen transformiert oder gefiltert werden. Dafür werden Regeln (<em>&ldquo;Metamorph&rdquo;</em>- oder kurz <em>&ldquo;Morph-Definition&rdquo;</em>) festgelegt, welche anschliessend durch Metafacture auf einzelne Felder
(identifiert durch Schlüssel-/Feldnamen) angewendet werden. Diese Regeln
sind als XML-Elemente formuliert, und daher sind auch Metamorph-Dateien &ldquo;normale&rdquo; XML-Dateien.</p>

<div class="notices note" ><p>Einen umfassenden Überblick über die erlaubten Elemente gibt das
<a href="https://github.com/metafacture/metafacture-core/blob/master/metamorph/src/main/resources/schemata/metamorph.xsd">Metamorph-Schema</a>.</p>
</div>


<h2 id="xml-struktur">XML-Struktur</h2>

<p>Jede Morph-Definition muss innerhalb des <code>&lt;metamorph&gt;</code>-Elementes abgelegt
werden:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;metamorph</span> <span style="color:#75af00">xmlns=</span><span style="color:#d88200">&#34;http://www.culturegraph.org/metamorph&#34;</span> <span style="color:#75af00">version=</span><span style="color:#d88200">&#34;1&#34;</span><span style="color:#f92672">&gt;</span>
  <span style="color:#75715e">&lt;!-- Hier kommen die Definitionen hin --&gt;</span>
<span style="color:#f92672">&lt;/metamorph&gt;</span></code></pre></div>
<p>Direkt unterhalb des <code>&lt;metamorph&gt;</code>-Elementes können folgende Elemente
definiert werden:</p>

<ul>
<li><code>&lt;include&gt;</code>: <a href="https://sschuepbach.github.io/metamorph-hacks/modularisierung/includes/">Einbinden von externen Definitionen</a></li>
<li><code>&lt;macros&gt;</code>: <a href="https://sschuepbach.github.io/metamorph-hacks/modularisierung/makros/">Dateiweite Funktionen</a></li>
<li><code>&lt;maps&gt;</code>: Liste von <a href="https://sschuepbach.github.io/metamorph-hacks/literale/nachschlagetabellen/">Nachschlagetabellen</a></li>
<li><code>&lt;meta&gt;</code>: Metadaten der Datei: Gültige Kindelemente sind <code>&lt;name&gt;</code> und
<code>&lt;annotation&gt;</code></li>
<li><code>&lt;rules&gt;</code>: Tranformations- und Filterregeln (die den Hauptteil dieser
Dokumentation ausmachen)</li>
<li><code>&lt;vars&gt;</code>: <a href="https://sschuepbach.github.io/metamorph-hacks/modularisierung/variablen/">Dateiweite Konstanten</a></li>
</ul>

<p>Metamorph selbst hat zwei eigene Attribute:</p>

<ul>
<li><code>version</code>: Die Version des Metamorph-Schemas</li>
<li><code>entityMarker</code>: Trennzeichen zwischen Entität und einem Literal</li>
</ul>

<h2 id="verwendung-von-metamorph-definitionen-in-metafacture">Verwendung von Metamorph-Definitionen in Metafacture</h2>

<p>In Metafacture werden Workflows mithilfe von sogenannten <a href="https://github.com/metafacture/metafacture-core/wiki/Flux-user-guide"><em>Flux</em></a>&rdquo;-Skripten festgelegt. Flux besteht aus einer Reihe von Befehlen (<em>commands</em>), die jeweils einen Teil des Workflows beschreiben (bspw. das Öffnen einer Datei oder das Dekodieren eines Formates).</p>

<div class="notices note" ><p>Ein Überblick der zur Verfügung stehenden <em>Flux</em>-Befehle ist <a href="https://github.com/linked-swissbib/mfWorkflows/tree/removed-mfrunner">hier</a> zu finden.</p>
</div>


<p>Um eine Morph-Definition in einem solchen Flux-Skript zu verwenden, wird
der Befehl <code>morph('/pfad/zur/morph/datei')</code> benutzt.</p>

<p>Daneben gibt es noch einen zweiten Befehl, der ebenfalls mit
Morph-Definitionen arbeitet: <code>filter('/pfad/zur/morph/datei')</code>. In einer
solchen Morph-Datei werden Regeln definiert - meistens das Vorhandensein einzelner
Felder -, welche von einem Datensatz erfüllt werden müssen, damit er im
Workflow weitergeleitet wird. Vielfach macht es Sinn, einen solchen Filter
mit einer nachfolgenden Transformation zu kombinieren, so beispielsweise
um zu vermeiden, dass Datensätze in die Transformation geschickt werden,
welche nicht &ldquo;regelkonform&rdquo; sind und daher zu unerwarteten Resultaten führen
können.</p>

<div class="notices note" ><p>Ein Beispiel für einen solchen Fall ist die &ldquo;baseline&rdquo;, ein
Datenworkflow in linked-swissbib, wo die Existenz eines gewissen Feldes -
MARC-Feld <code>245*.a</code> - Voraussetzung dafür ist, dass weitere Felder eines
Datensatzes im
Morph-Schritt korrekt zusammengefügt werden.</p>
</div>



    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/metamorph-hacks/einfuehrung/" title="Einführung"> <i class="fa fa-chevron-left"></i><label>Einführung</label></a>
    <a class="nav nav-next" href="/metamorph-hacks/einfuehrung/hinweise-codebeispiele/" title="Hinweise zu Codebeispielen" style="margin-right: 0px;"><label>Hinweise zu Codebeispielen</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  
    <div class="date">
        <i class='fa fa-calendar'></i>  23/08/2018
    </div>
    

    <div class="github-link">
      <a href="https://github.com/sschuepbach/metamorph-hacks/edit/master/content/einfuehrung/metamorph.md" target="blank"><i class="fa fa-code-fork"></i>
        </a>
    </div>
  </div>


	<div>


  
    
  



	</div>
</footer>

<script src="/metamorph-hacks/js/clipboard.min.js"></script>

<link href="/metamorph-hacks/css/featherlight.min.css" rel="stylesheet">
<script src="/metamorph-hacks/js/featherlight.min.js"></script>



<script src="/metamorph-hacks/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>